<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Document PiP + Blob</title>
<style>
  button {
    padding: 12px 16px;
    font-size: 16px;
    cursor: pointer;
  }
</style>
</head>
<body>

<button id="open">Open Document PiP (Blob)</button>

<script>
document.getElementById("open").addEventListener("click", async () => {
  if (!("documentPictureInPicture" in window)) {
    alert("Document PiP not supported");
    return;
  }

  // 1. Create HTML content
  const pipHTML = `
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #111;
    color: #0f0;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }
</style>
</head>
<body>
  <h2>ðŸ“¦ Blob â†’ Document PiP</h2>

  <script>
    setInterval(() => {
      document.body.querySelector("h2").textContent =
        "ðŸŸ¢ Live PiP " + new Date().toLocaleTimeString();
    }, 1000);
  <\/script>
</body>
</html>
  `;

  // 2. Blob â†’ URL
  const blob = new Blob([pipHTML], { type: "text/html" });
  const blobURL = URL.createObjectURL(blob);

  // 3. Open Document PiP window
  const pipWindow = await documentPictureInPicture.requestWindow({
    width: 360,
    height: 200
  });

  // 4. Load blob into PiP window
  const iframe = pipWindow.document.createElement("iframe");
  iframe.src = blobURL;
  iframe.style.border = "0";
  iframe.style.width = "100%";
  iframe.style.height = "100%";

  pipWindow.document.body.style.margin = "0";
  pipWindow.document.body.appendChild(iframe);

  // cleanup
  pipWindow.addEventListener("pagehide", () => {
    URL.revokeObjectURL(blobURL);
  });
});
</script>

</body>
</html>
